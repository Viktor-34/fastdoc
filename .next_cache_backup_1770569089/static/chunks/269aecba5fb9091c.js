(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31278,e=>{"use strict";e.s(["Loader2",()=>t],31278);let t=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},48303,e=>{"use strict";e.s(["SiteHeader",()=>a]);var t=e.i(43476),l=e.i(11522);function a(e){let{label:a,title:r,description:s,actions:i}=e;return(0,t.jsx)("header",{className:"sticky top-0 z-20 border-b border-neutral-200 bg-white",children:(0,t.jsxs)("div",{className:"flex w-full items-center justify-between gap-3 px-4 py-3 md:px-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(l.SidebarTrigger,{className:"-ml-1"}),(0,t.jsx)("span",{className:"h-6 w-px bg-neutral-200","aria-hidden":"true"}),(0,t.jsxs)("div",{className:"flex flex-col",children:[a&&(0,t.jsx)("span",{className:"text-xs text-neutral-500",children:a}),(0,t.jsx)("h1",{className:"text-base font-medium text-neutral-900",children:r}),s&&(0,t.jsx)("p",{className:"text-xs text-neutral-500",children:s})]})]}),i?(0,t.jsx)("div",{className:"shrink-0",children:i}):null]})})}},70065,e=>{"use strict";e.s(["Card",()=>a,"CardContent",()=>o,"CardDescription",()=>i,"CardFooter",()=>n,"CardHeader",()=>r,"CardTitle",()=>s]);var t=e.i(43476),l=e.i(47163);function a(e){let{className:a,...r}=e;return(0,t.jsx)("div",{"data-slot":"card",className:(0,l.cn)("bg-white text-neutral-950 flex flex-col gap-6 rounded-xl border border-neutral-200 py-6 shadow-sm dark:bg-neutral-950 dark:text-neutral-50 dark:border-neutral-800",a),...r})}function r(e){let{className:a,...r}=e;return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,l.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto]",a),...r})}function s(e){let{className:a,...r}=e;return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,l.cn)("leading-none font-semibold",a),...r})}function i(e){let{className:a,...r}=e;return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,l.cn)("text-neutral-500 text-sm dark:text-neutral-400",a),...r})}function o(e){let{className:a,...r}=e;return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,l.cn)("px-6",a),...r})}function n(e){let{className:a,...r}=e;return(0,t.jsx)("div",{"data-slot":"card-footer",className:(0,l.cn)("flex items-center px-6 [.border-t]:pt-6",a),...r})}},46349,e=>{"use strict";e.s(["default",()=>t]);let t=(0,e.i(75254).default)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},73375,63059,e=>{"use strict";e.s(["ChevronLeft",()=>t],73375);let t=(0,e.i(75254).default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);e.s(["ChevronRight",()=>l.default],63059);var l=e.i(46349)},14041,e=>{"use strict";e.s(["ProposalsBoard",()=>N],14041);var t=e.i(43476),l=e.i(71645),a=e.i(22016),r=e.i(73375),s=e.i(63059),i=e.i(75254);let o=(0,i.default)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),n=(0,i.default)("link-2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);var c=e.i(31278),d=e.i(27612),x=e.i(67881),u=e.i(70065);let h={draft:{label:"Черновик",backgroundColor:"#F3F2F0",color:"#73726c",borderColor:"hsl(30deg 3.3% 11.8% / 15%)"},sent:{label:"Отправлено",backgroundColor:"#FAEFEB",color:"#A04F33",borderColor:"#E4B5A6"},accepted:{label:"Принято",backgroundColor:"#EAF6EE",color:"#2F6B45",borderColor:"#B9DEC8"},rejected:{label:"Отклонено",backgroundColor:"#FDEDED",color:"#A53A3A",borderColor:"#E9B8B8"}},m="hsl(30deg 3.3% 11.8% / 15%)",p="#3d3d3a",b="#73726c",f=async e=>{var t,l,a;if(null==(t=navigator.clipboard)?void 0:t.writeText)try{"function"!=typeof document.hasFocus||document.hasFocus()||null==(l=(a=window).focus)||l.call(a),await navigator.clipboard.writeText(e);return}catch(e){console.warn("Clipboard API unavailable, using fallback",e)}(()=>{let t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.focus(),t.select(),document.execCommand("copy"),document.body.removeChild(t)})()};function j(e){let{initialDocuments:i,query:j="",statusFilter:g="all"}=e,[v,y]=(0,l.useState)(i),[N,w]=(0,l.useState)(null),[C,k]=(0,l.useState)(null),[F,A]=(0,l.useState)(null),[S,_]=(0,l.useState)(null),[z,E]=(0,l.useState)(1),[T,B]=(0,l.useState)(10),L=async e=>{w(e);try{let t=await fetch("/api/proposals/".concat(e),{method:"DELETE"});if(!t.ok)throw Error(await t.text());y(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Failed to delete proposal",e),alert("Не удалось удалить предложение")}finally{w(null)}},M=async e=>{try{k(e);let t=await fetch("/api/proposals/".concat(e,"/share"),{method:"POST"});if(!t.ok)throw Error(await t.text());let l=await t.json(),a="".concat(window.location.origin,"/p/").concat(l.token);await f(a),A(e),window.setTimeout(()=>{A(t=>t===e?null:t)},2e3)}catch(e){console.error("Failed to copy share link",e),alert("Не удалось скопировать ссылку")}finally{k(null)}},D=async e=>{_(e);try{let t=await fetch("/api/proposals/".concat(e,"/duplicate"),{method:"POST"});if(!t.ok)throw Error(await t.text());let l=await t.json();y(e=>[{id:l.id,title:l.title,createdAt:l.createdAt,updatedAt:l.updatedAt,updatedBy:l.updatedBy,clientName:null},...e]),alert("Предложение успешно дублировано")}catch(e){console.error("Failed to duplicate proposal",e),alert("Не удалось дублировать предложение")}finally{_(null)}},P=(0,l.useMemo)(()=>{let e=v;"all"!==g&&(e=e.filter(e=>e.status===g));let t=j.trim().toLowerCase();return t&&(e=e.filter(e=>{var l,a;return[e.title,null!=(l=e.updatedBy)?l:"",null!=(a=e.clientName)?a:""].some(e=>e.toLowerCase().includes(t))})),e},[v,j,g]),R=Math.ceil(P.length/T),I=(z-1)*T,O=I+T,U=P.slice(I,O);return((0,l.useMemo)(()=>{E(1)},[j,g]),0===v.length)?(0,t.jsx)(u.Card,{className:"border border-dashed p-0",children:(0,t.jsxs)(u.CardContent,{className:"flex flex-col gap-4 px-6 py-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)(u.CardTitle,{className:"text-base font-semibold text-neutral-900",children:"Пока нет предложений"}),(0,t.jsx)("p",{className:"text-sm text-neutral-500",children:"Создайте новое предложение, чтобы начать работу."})]}),(0,t.jsx)(x.Button,{asChild:!0,size:"sm",className:"self-start",children:(0,t.jsx)(a.default,{href:"/editor",children:"Создать предложение"})})]})}):0===P.length?(0,t.jsx)("div",{className:"rounded-xl border border-dashed border-neutral-200 bg-white px-6 py-8 text-center text-sm text-neutral-500",children:"Ничего не найдено. Попробуйте изменить запрос."}):(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsx)("div",{className:"overflow-hidden rounded-lg border",style:{borderColor:m},children:(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("div",{className:"min-w-[960px]",children:[(0,t.jsxs)("div",{className:"flex h-10 items-center gap-8 border-b",style:{borderColor:m,backgroundColor:"rgb(243, 242, 240)"},children:[(0,t.jsx)("div",{className:"min-w-[220px] flex-1 px-[10px] pl-[26px]",children:(0,t.jsx)("span",{className:"text-[12px] font-medium tracking-tight",style:{color:p},children:"Название"})}),(0,t.jsx)("div",{className:"w-[120px] shrink-0 px-2",children:(0,t.jsx)("span",{className:"text-[12px] font-medium tracking-tight",style:{color:p},children:"Статус"})}),(0,t.jsx)("div",{className:"w-[180px] shrink-0 px-2",children:(0,t.jsx)("span",{className:"text-[12px] font-medium tracking-tight",style:{color:p},children:"Клиент"})}),(0,t.jsx)("div",{className:"w-[220px] shrink-0 px-2 pl-6",children:(0,t.jsx)("span",{className:"text-[12px] font-medium tracking-tight",style:{color:p},children:"Обновлено"})}),(0,t.jsx)("div",{className:"shrink-0 px-2","aria-hidden":"true",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 opacity-0",children:[(0,t.jsx)("span",{className:"inline-block size-4"}),(0,t.jsx)("span",{className:"inline-block size-8"}),(0,t.jsx)("span",{className:"inline-block size-8"})]})})]}),(0,t.jsx)("div",{className:"bg-white",children:U.map(e=>{let l=N===e.id,r=C===e.id,s=F===e.id,i=S===e.id;return(0,t.jsxs)("div",{className:"flex items-center gap-8 border-b transition-colors hover:bg-neutral-50",style:{borderColor:m},children:[(0,t.jsx)("div",{className:"min-w-[220px] flex-1 px-[10px] py-2 pl-[26px]",children:(0,t.jsx)(a.default,{href:"/editor?proposalId=".concat(e.id),className:"block truncate text-[14px] font-medium tracking-tight transition-colors hover:text-neutral-700",style:{color:p},children:e.title||"Без названия"})}),(0,t.jsx)("div",{className:"flex w-[120px] shrink-0 items-center px-2 py-2",children:(()=>{var l;let a=h[null!=(l=e.status)?l:"draft"];return(0,t.jsx)("span",{className:"inline-flex h-[22px] items-center rounded-full border px-[10px] text-[12px] font-medium",style:{backgroundColor:a.backgroundColor,color:a.color,borderColor:a.borderColor},children:a.label})})()}),(0,t.jsx)("div",{className:"flex w-[180px] shrink-0 items-center px-2 py-2",children:e.clientName?(0,t.jsx)("div",{className:"flex h-[22px] items-center justify-center rounded-full border px-[10px]",style:{backgroundColor:"#F3F2F0",borderColor:m},children:(0,t.jsx)("span",{className:"max-w-[150px] truncate text-[12px] font-medium",style:{color:p},children:e.clientName})}):(0,t.jsx)("span",{className:"text-xs text-neutral-400",children:"—"})}),(0,t.jsx)("div",{className:"flex w-[220px] shrink-0 items-center px-2 py-2 pl-6",children:(0,t.jsxs)("span",{className:"whitespace-nowrap text-[12px] font-medium",style:{color:"rgb(115, 114, 108)"},children:[new Date(e.updatedAt).toLocaleDateString("ru-RU",{day:"numeric",month:"short",year:"numeric"})," ",new Date(e.updatedAt).toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})]})}),(0,t.jsxs)("div",{className:"flex shrink-0 items-center gap-2 px-2",children:[(0,t.jsx)("button",{type:"button",disabled:r,onClick:()=>M(e.id),className:"flex items-center gap-2 transition-colors hover:text-neutral-900 disabled:opacity-50",style:{color:b},title:s?"Скопировано":"Скопировать ссылку",children:r?(0,t.jsx)(c.Loader2,{className:"size-4 animate-spin"}):(0,t.jsx)(n,{className:"size-4"})}),(0,t.jsx)("button",{type:"button",disabled:i,onClick:()=>D(e.id),className:"flex size-8 items-center justify-center rounded-md transition-colors hover:bg-neutral-100 hover:text-[var(--field-focus)] disabled:opacity-50",style:{color:b},title:"Дублировать",children:i?(0,t.jsx)(c.Loader2,{className:"size-4 animate-spin"}):(0,t.jsx)(o,{className:"size-4"})}),(0,t.jsx)("button",{type:"button",disabled:l,onClick:()=>L(e.id),className:"flex size-8 items-center justify-center rounded-md transition-colors hover:bg-neutral-100 hover:text-red-500 disabled:opacity-50",style:{color:b},title:"Удалить",children:l?(0,t.jsx)(c.Loader2,{className:"size-4 animate-spin"}):(0,t.jsx)(d.Trash2,{className:"size-4"})})]})]},e.id)})})]})})}),R>1&&(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)("select",{value:T,onChange:e=>{B(Number(e.target.value)),E(1)},className:"h-9 rounded-lg border border-[var(--field-border)] bg-white px-[13px] py-[9px] text-xs shadow-[0px_1px_2px_0px_rgba(0,0,0,0.05)] transition-[color,box-shadow,border-color] focus:border-[var(--field-focus)] focus:outline-none focus:ring-[3px] focus:ring-[var(--field-ring)]",style:{color:p},children:[(0,t.jsx)("option",{value:10,children:"10"}),(0,t.jsx)("option",{value:25,children:"25"}),(0,t.jsx)("option",{value:50,children:"50"}),(0,t.jsx)("option",{value:100,children:"100"})]})}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("span",{className:"mr-8 text-sm",style:{color:b},children:[I+1,"-",Math.min(O,P.length)," из ",P.length]}),(0,t.jsx)("button",{onClick:()=>E(e=>Math.max(1,e-1)),disabled:1===z,className:"flex size-8 items-center justify-center rounded-lg border bg-white shadow-[0px_1px_2px_0px_rgba(0,0,0,0.05)] transition-colors hover:bg-neutral-50 disabled:cursor-not-allowed disabled:opacity-50",style:{borderColor:m,color:b},title:"Предыдущая страница",children:(0,t.jsx)(r.ChevronLeft,{className:"size-4"})}),Array.from({length:Math.min(6,R)},(e,l)=>{let a;return a=R<=6||z<=3?l+1:z>=R-2?R-5+l:z-2+l,(0,t.jsx)("button",{onClick:()=>E(a),className:"flex size-8 items-center justify-center rounded-lg text-sm transition-colors ".concat(z===a?"bg-[#C6613F] text-white":"text-neutral-600 hover:bg-neutral-100"),children:a},a)}),(0,t.jsx)("button",{onClick:()=>E(e=>Math.min(R,e+1)),disabled:z===R,className:"flex size-8 items-center justify-center rounded-lg border bg-white shadow-[0px_1px_2px_0px_rgba(0,0,0,0.05)] transition-colors hover:bg-neutral-50 disabled:cursor-not-allowed disabled:opacity-50",style:{borderColor:m,color:b},title:"Следующая страница",children:(0,t.jsx)(s.ChevronRight,{className:"size-4"})})]})]})]})}var g=e.i(23750),v=e.i(62870);let y=[{value:"all",label:"Все статусы"},{value:"draft",label:"Черновик"},{value:"sent",label:"Отправлено"},{value:"accepted",label:"Принято"},{value:"rejected",label:"Отклонено"}];function N(e){var r;let{initialDocuments:s}=e,[i,o]=(0,l.useState)(""),[n,c]=(0,l.useState)("all");return(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(g.Input,{type:"search",value:i,onChange:e=>o(e.target.value),placeholder:"Поиск по названию или клиенту",className:"w-full max-w-sm"}),(0,t.jsxs)(v.Select,{value:n,onValueChange:e=>c(e),children:[(0,t.jsx)(v.SelectTrigger,{className:"h-9 w-[200px] rounded-[12px] border border-[#E2E8F0] bg-white px-4 text-sm font-medium tracking-[-0.42px] text-[#0F172B] shadow-[0_1px_2px_rgba(10,10,10,0.06)]",children:(0,t.jsx)(v.SelectValue,{children:(null==(r=y.find(e=>e.value===n))?void 0:r.label)||"Все статусы"})}),(0,t.jsx)(v.SelectContent,{children:y.map(e=>(0,t.jsx)(v.SelectItem,{value:e.value,children:e.label},e.value))})]})]}),(0,t.jsx)(x.Button,{asChild:!0,className:"h-9 rounded-xl bg-[#C6613F] px-4 text-sm font-medium text-[#FAFAFA] shadow-[0px_1px_2px_0px_rgba(10,10,10,0.06)] hover:bg-[#A04F33]",children:(0,t.jsx)(a.default,{href:"/editor",children:"Создать предложение"})})]}),(0,t.jsx)(j,{initialDocuments:s,query:i,statusFilter:n})]})}}]);