(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,10708,e=>{"use strict";e.s(["Label",()=>n],10708);var a=e.i(43476),t=e.i(71645),l=e.i(48425),s=t.forwardRef((e,t)=>(0,a.jsx)(l.Primitive.label,{...e,ref:t,onMouseDown:a=>{var t;a.target.closest("button, input, select, textarea")||(null==(t=e.onMouseDown)||t.call(e,a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));s.displayName="Label";var r=e.i(47163);function n(e){let{className:t,...l}=e;return(0,a.jsx)(s,{"data-slot":"label",className:(0,r.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...l})}},31278,e=>{"use strict";e.s(["Loader2",()=>a],31278);let a=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},48303,e=>{"use strict";e.s(["SiteHeader",()=>l]);var a=e.i(43476),t=e.i(11522);function l(e){let{label:l,title:s,description:r,actions:n}=e;return(0,a.jsx)("header",{className:"sticky top-0 z-20 border-b border-neutral-200 bg-white",children:(0,a.jsxs)("div",{className:"flex w-full items-center justify-between gap-3 px-4 py-3 md:px-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(t.SidebarTrigger,{className:"-ml-1"}),(0,a.jsx)("span",{className:"h-6 w-px bg-neutral-200","aria-hidden":"true"}),(0,a.jsxs)("div",{className:"flex flex-col",children:[l&&(0,a.jsx)("span",{className:"text-xs text-neutral-500",children:l}),(0,a.jsx)("h1",{className:"text-base font-medium text-neutral-900",children:s}),r&&(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:r})]})]}),n?(0,a.jsx)("div",{className:"shrink-0",children:n}):null]})})}},70065,e=>{"use strict";e.s(["Card",()=>l,"CardContent",()=>o,"CardDescription",()=>n,"CardFooter",()=>i,"CardHeader",()=>s,"CardTitle",()=>r]);var a=e.i(43476),t=e.i(47163);function l(e){let{className:l,...s}=e;return(0,a.jsx)("div",{"data-slot":"card",className:(0,t.cn)("bg-white text-neutral-950 flex flex-col gap-6 rounded-xl border border-neutral-200 py-6 shadow-sm dark:bg-neutral-950 dark:text-neutral-50 dark:border-neutral-800",l),...s})}function s(e){let{className:l,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,t.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto]",l),...s})}function r(e){let{className:l,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,t.cn)("leading-none font-semibold",l),...s})}function n(e){let{className:l,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,t.cn)("text-neutral-500 text-sm dark:text-neutral-400",l),...s})}function o(e){let{className:l,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,t.cn)("px-6",l),...s})}function i(e){let{className:l,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-footer",className:(0,t.cn)("flex items-center px-6 [.border-t]:pt-6",l),...s})}},48435,e=>{"use strict";e.s(["default",()=>x]);var a=e.i(43476),t=e.i(71645),l=e.i(18566),s=e.i(31278),r=e.i(67881),n=e.i(70065),o=e.i(23750),i=e.i(10708),d=e.i(69035);let c="#3d3d3a",m="#73726c",u="h-auto w-full rounded-lg border border-[var(--field-border)] bg-white px-4 py-2.5 text-sm text-slate-900 placeholder:text-[var(--field-placeholder)] transition-[color,box-shadow,border-color] focus:border-[var(--field-focus)] focus:outline-none focus:ring-[3px] focus:ring-[var(--field-ring)]";function x(e){var x,p,h,b,f,v,j;let{initialData:N,clientId:g,mode:y}=e,w=(0,l.useRouter)(),[C,k]=(0,t.useState)(!1),[P,F]=(0,t.useState)({name:null!=(x=null==N?void 0:N.name)?x:"",company:null!=(p=null==N?void 0:N.company)?p:"",contactPerson:null!=(h=null==N?void 0:N.contactPerson)?h:"",middleName:null!=(b=null==N?void 0:N.middleName)?b:"",position:null!=(f=null==N?void 0:N.position)?f:"",email:null!=(v=null==N?void 0:N.email)?v:"",phone:null!=(j=null==N?void 0:N.phone)?j:""}),[L,S]=(0,t.useState)({}),T=async e=>{if(e.preventDefault(),(()=>{let e={};return P.name.trim()||(e.name="Имя обязательно"),P.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(P.email)||(e.email="Некорректный email"):e.email="Email обязателен",S(e),0===Object.keys(e).length})()){k(!0);try{let e=await fetch("create"===y?"/api/clients":"/api/clients/".concat(g),{method:"create"===y?"POST":"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:P.name,company:P.company||void 0,contactPerson:P.contactPerson||void 0,middleName:P.middleName||void 0,position:P.position||void 0,email:P.email,phone:P.phone||void 0})});if(!e.ok){let a=await e.json();throw Error(a.error||"Failed to save client")}w.push("/clients"),w.refresh()}catch(e){console.error("Failed to save client:",e),alert(e instanceof Error?e.message:"Не удалось сохранить клиента")}finally{k(!1)}}},I=(e,a)=>{F(t=>({...t,[e]:a})),L[e]&&S(a=>({...a,[e]:void 0}))};return(0,a.jsxs)(n.Card,{className:"w-full rounded-[0.75rem] border-0 bg-white px-0 py-0 shadow-none",style:{boxShadow:"0 1px 1px 0 rgba(0, 0, 0, 0.06), 0 0 1px 0 rgba(0, 0, 0, 0.3)"},children:[(0,a.jsx)(n.CardContent,{className:"space-y-6 px-4 py-6 md:px-6",children:(0,a.jsxs)("form",{id:"client-form",onSubmit:T,className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"mb-2 text-sm font-medium",style:{color:c},children:"Основная информация"}),(0,a.jsx)("p",{className:"text-xs",style:{color:m},children:"Заполните данные клиента для быстрого выбора в коммерческих предложениях."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(i.Label,{htmlFor:"name",className:"mb-2 block text-sm font-medium",style:{color:c},children:"Имя клиента *"}),(0,a.jsx)(o.Input,{id:"name",value:P.name,onChange:e=>I("name",e.target.value),placeholder:"Иван Иванов или ООО «Компания»",disabled:C,className:u}),L.name&&(0,a.jsx)("p",{className:"mt-2 text-sm text-rose-600",children:L.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(i.Label,{htmlFor:"company",className:"mb-2 block text-sm font-medium",style:{color:c},children:"Название компании"}),(0,a.jsx)(o.Input,{id:"company",value:P.company,onChange:e=>I("company",e.target.value),placeholder:"ООО «Название»",disabled:C,className:u})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(i.Label,{htmlFor:"contactPerson",className:"mb-2 block text-sm font-medium",style:{color:c},children:"Контактное лицо"}),(0,a.jsx)(o.Input,{id:"contactPerson",value:P.contactPerson,onChange:e=>I("contactPerson",e.target.value),placeholder:"Иван",disabled:C,className:u})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(i.Label,{htmlFor:"middleName",className:"mb-2 block text-sm font-medium",style:{color:c},children:"Отчество"}),(0,a.jsx)(o.Input,{id:"middleName",value:P.middleName,onChange:e=>I("middleName",e.target.value),placeholder:"Иванович",disabled:C,className:u})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(i.Label,{htmlFor:"position",className:"mb-2 block text-sm font-medium",style:{color:c},children:"Должность"}),(0,a.jsx)(o.Input,{id:"position",value:P.position,onChange:e=>I("position",e.target.value),placeholder:"Директор",disabled:C,className:u})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(i.Label,{htmlFor:"email",className:"mb-2 block text-sm font-medium",style:{color:c},children:"Email *"}),(0,a.jsx)(o.Input,{id:"email",type:"email",value:P.email,onChange:e=>I("email",e.target.value),placeholder:"email@example.com",disabled:C,className:u}),L.email&&(0,a.jsx)("p",{className:"mt-2 text-sm text-rose-600",children:L.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(i.Label,{htmlFor:"phone",className:"mb-2 block text-sm font-medium",style:{color:c},children:"Телефон"}),(0,a.jsx)(o.Input,{id:"phone",type:"tel",value:P.phone,onChange:e=>I("phone",e.target.value),placeholder:"+7 (999) 123-45-67",disabled:C,className:u}),(0,a.jsx)("p",{className:"mt-1.5 text-xs",style:{color:m},children:"Необязательное поле. Используется для быстрого контакта с клиентом."})]})]})}),(0,a.jsx)(d.Separator,{style:{backgroundColor:"var(--field-border)"}}),(0,a.jsxs)(n.CardFooter,{className:"flex flex-col gap-3 py-6 md:flex-row md:items-center md:justify-between",children:[(0,a.jsx)("p",{className:"text-sm",style:{color:m},children:"Убедитесь, что все данные актуальны. После сохранения клиент будет доступен в списке."}),(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsxs)(r.Button,{type:"submit",form:"client-form",disabled:C,children:[C?(0,a.jsx)(s.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):null,"create"===y?"Создать":"Сохранить"]})})]})]})}}]);