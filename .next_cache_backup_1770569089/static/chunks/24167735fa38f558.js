(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,83996,e=>{"use strict";e.s(["default",()=>n]);var t=e.i(43476),i=e.i(71645);function n(e){let{token:n,proposalHtml:o}=e,[r,d]=(0,i.useState)("100vh");return(0,i.useEffect)(()=>{let e=e=>{var t;if((null==(t=e.data)?void 0:t.type)!=="resize")return;let i=e.data.height;if("number"!=typeof i||!Number.isFinite(i))return;let n=Math.max(320,Math.round(i+40));d("".concat(n,"px"))};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[]),(0,i.useEffect)(()=>{let e=localStorage.getItem("uid");e||(e=Math.random().toString(36).slice(2),localStorage.setItem("uid",e));let t=function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};fetch("/api/track",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({token:n,event:t,uid:e,meta:i,ref:document.referrer})}).catch(()=>{})};t("opened");let i=null,o=()=>{null===i&&(i=window.setInterval(()=>t("time",{seconds:15}),15e3))},r=()=>{null!==i&&(window.clearInterval(i),i=null)},d=()=>{"visible"===document.visibilityState?o():r()};return document.addEventListener("visibilitychange",d),"visible"===document.visibilityState&&o(),()=>{r(),document.removeEventListener("visibilitychange",d)}},[n]),(0,t.jsxs)("div",{className:"public-preview",children:[(0,t.jsx)("div",{style:{width:"min(900px, 100%)",margin:"0 auto",background:"#ffffff",borderRadius:"20px",boxShadow:"0 24px 48px -32px rgba(15,23,42,0.25)",overflow:"hidden"},children:(0,t.jsx)("iframe",{srcDoc:o,style:{width:"100%",height:r,border:"none",display:"block"},title:"Коммерческое предложение"})}),(0,t.jsx)("div",{style:{textAlign:"center",margin:"32px 0"},children:(0,t.jsx)("button",{type:"button",id:"downloadPdf",className:"download-button",onClick:()=>{fetch("/api/track",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({token:n,event:"download",uid:localStorage.getItem("uid")||void 0,ref:document.referrer})}).catch(()=>{}),window.open("/p/".concat(n,"/pdf"),"_blank","noopener,noreferrer")},children:"Скачать PDF"})})]})}}]);