module.exports=[5050,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(c,{callServer:function(){return d.callServer},createServerReference:function(){return f.createServerReference},findSourceMapURL:function(){return e.findSourceMapURL}});let d=a.r(20611),e=a.r(1722),f=a.r(38783)},22216,a=>{"use strict";a.s(["ProfileForm",()=>U],22216);var b=a.i(87924),c=a.i(72131),d=a.i(60246),e=a.i(40695),f=a.i(3130),g=a.i(5522),h=a.i(17171),i=a.i(7379),j=a.i(7554),k=a.i(50104),l=a.i(24050),m=a.i(77192),n=a.i(30553),o=a.i(7827),p=a.i(25152),q=a.i(92843),r="Tabs",[s,t]=(0,k.createContextScope)(r,[l.createRovingFocusGroupScope]),u=(0,l.createRovingFocusGroupScope)(),[v,w]=s(r),x=c.forwardRef((a,c)=>{let{__scopeTabs:d,value:e,onValueChange:f,defaultValue:g,orientation:h="horizontal",dir:i,activationMode:j="automatic",...k}=a,l=(0,o.useDirection)(i),[m,s]=(0,p.useControllableState)({prop:e,onChange:f,defaultProp:g??"",caller:r});return(0,b.jsx)(v,{scope:d,baseId:(0,q.useId)(),value:m,onValueChange:s,orientation:h,dir:l,activationMode:j,children:(0,b.jsx)(n.Primitive.div,{dir:l,"data-orientation":h,...k,ref:c})})});x.displayName=r;var y="TabsList",z=c.forwardRef((a,c)=>{let{__scopeTabs:d,loop:e=!0,...f}=a,g=w(y,d),h=u(d);return(0,b.jsx)(l.Root,{asChild:!0,...h,orientation:g.orientation,dir:g.dir,loop:e,children:(0,b.jsx)(n.Primitive.div,{role:"tablist","aria-orientation":g.orientation,...f,ref:c})})});z.displayName=y;var A="TabsTrigger",B=c.forwardRef((a,c)=>{let{__scopeTabs:d,value:e,disabled:f=!1,...g}=a,h=w(A,d),i=u(d),k=E(h.baseId,e),m=F(h.baseId,e),o=e===h.value;return(0,b.jsx)(l.Item,{asChild:!0,...i,focusable:!f,active:o,children:(0,b.jsx)(n.Primitive.button,{type:"button",role:"tab","aria-selected":o,"aria-controls":m,"data-state":o?"active":"inactive","data-disabled":f?"":void 0,disabled:f,id:k,...g,ref:c,onMouseDown:(0,j.composeEventHandlers)(a.onMouseDown,a=>{f||0!==a.button||!1!==a.ctrlKey?a.preventDefault():h.onValueChange(e)}),onKeyDown:(0,j.composeEventHandlers)(a.onKeyDown,a=>{[" ","Enter"].includes(a.key)&&h.onValueChange(e)}),onFocus:(0,j.composeEventHandlers)(a.onFocus,()=>{let a="manual"!==h.activationMode;o||f||!a||h.onValueChange(e)})})})});B.displayName=A;var C="TabsContent",D=c.forwardRef((a,d)=>{let{__scopeTabs:e,value:f,forceMount:g,children:h,...i}=a,j=w(C,e),k=E(j.baseId,f),l=F(j.baseId,f),o=f===j.value,p=c.useRef(o);return c.useEffect(()=>{let a=requestAnimationFrame(()=>p.current=!1);return()=>cancelAnimationFrame(a)},[]),(0,b.jsx)(m.Presence,{present:g||o,children:({present:c})=>(0,b.jsx)(n.Primitive.div,{"data-state":o?"active":"inactive","data-orientation":j.orientation,role:"tabpanel","aria-labelledby":k,hidden:!c,id:l,tabIndex:0,...i,ref:d,style:{...a.style,animationDuration:p.current?"0s":void 0},children:c&&h})})});function E(a,b){return`${a}-trigger-${b}`}function F(a,b){return`${a}-content-${b}`}D.displayName=C;var G=a.i(97895);function H({className:a,...c}){return(0,b.jsx)(x,{"data-slot":"tabs",className:(0,G.cn)("flex flex-col gap-2",a),...c})}function I({className:a,...c}){return(0,b.jsx)(z,{"data-slot":"tabs-list",className:(0,G.cn)("bg-neutral-100 text-neutral-500 inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px] dark:bg-neutral-800 dark:text-neutral-400",a),...c})}function J({className:a,...c}){return(0,b.jsx)(B,{"data-slot":"tabs-trigger",className:(0,G.cn)("data-[state=active]:bg-[#FAEFEB] data-[state=active]:text-[#3d3d3a] dark:data-[state=active]:text-[#3d3d3a] focus-visible:border-[#C6613F] focus-visible:ring-[#E4B5A6] dark:data-[state=active]:border-[#D8A18E] dark:data-[state=active]:bg-[#FAEFEB] text-neutral-950 dark:text-neutral-500 inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-neutral-200 border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 dark:data-[state=active]:bg-[#FAEFEB] dark:dark:data-[state=active]:text-[#3d3d3a] dark:focus-visible:border-[#C6613F] dark:focus-visible:ring-[#E4B5A6] dark:dark:data-[state=active]:border-[#D8A18E] dark:dark:data-[state=active]:bg-[#FAEFEB] dark:text-neutral-50 dark:dark:text-neutral-400 dark:border-neutral-800",a),...c})}function K({className:a,...c}){return(0,b.jsx)(D,{"data-slot":"tabs-content",className:(0,G.cn)("flex-1 outline-none",a),...c})}var L=a.i(23292),M=a.i(5050),N=(0,M.createServerReference)("406c84f908e763ca671df01a848344064d8793d0ba",M.callServer,void 0,M.findSourceMapURL,"updateProfile"),O=(0,M.createServerReference)("409f45195d04076d76acf35c1160776c07c77957ca",M.callServer,void 0,M.findSourceMapURL,"updateWorkspace");let P="hsl(30deg 3.3% 11.8% / 15%)",Q="#3d3d3a",R="#73726c",S={boxShadow:"0 1px 1px 0 rgba(0, 0, 0, 0.06), 0 0 1px 0 rgba(0, 0, 0, 0.3)"},T="h-9 gap-1.5 rounded-xl bg-[#C6613F] px-4 text-sm font-medium text-[#FAFAFA] shadow-[0px_1px_2px_0px_rgba(10,10,10,0.06)] hover:bg-[#A04F33]";function U({initialName:a,email:j,workspaceId:k,workspaceData:l,canEditWorkspace:m}){let[n,o]=(0,c.useState)(a),[p,q]=(0,c.useState)(l?.name??""),[r,s]=(0,c.useTransition)(),[t,u]=(0,c.useTransition)(),[v,w]=(0,c.useState)({logoUrl:l?.logoUrl??null,signatureUrl:l?.signatureUrl??null,stampUrl:l?.stampUrl??null,companyName:l?.companyName??"",inn:l?.inn??"",ogrn:l?.ogrn??"",legalAddress:l?.legalAddress??"",bankName:l?.bankName??"",bik:l?.bik??"",accountNumber:l?.accountNumber??"",vatDefault:l?.vatDefault??!0,vatRate:l?.vatRate??20}),[x,y]=(0,c.useState)(null),[z,A]=(0,c.useState)(!1),B=(a,b)=>{w(c=>({...c,[a]:b}))},C=async(a,b)=>{if(!b.type.startsWith("image/"))return void L.toast.error("Пожалуйста, загрузите изображение");if(b.size>5242880)return void L.toast.error("Размер файла не должен превышать 5MB");y(a);try{let c=new FormData;c.append("file",b),c.append("field",a);let d=await fetch("/api/workspace/upload",{method:"POST",body:c});if(!d.ok)throw Error("Ошибка загрузки");let{url:e}=await d.json();B(a,e),L.toast.success("Файл загружен")}catch(a){console.error("Upload error:",a),L.toast.error("Не удалось загрузить файл")}finally{y(null)}},D=async()=>{A(!0);try{if(!(await fetch("/api/workspace/settings",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(v)})).ok)throw Error("Ошибка сохранения");L.toast.success("Настройки сохранены")}catch(a){console.error("Save error:",a),L.toast.error("Не удалось сохранить настройки")}finally{A(!1)}};return(0,b.jsxs)(H,{defaultValue:"profile",className:"w-full",children:[(0,b.jsxs)(I,{className:"grid h-12 w-full grid-cols-3 rounded-xl border p-1.5",style:{borderColor:P,backgroundColor:"rgb(243, 242, 240)"},children:[(0,b.jsx)(J,{value:"profile",className:"h-9 rounded-lg text-sm font-medium data-[state=active]:bg-white",children:"Профиль"}),(0,b.jsx)(J,{value:"workspace",className:"h-9 rounded-lg text-sm font-medium data-[state=active]:bg-white",children:"Рабочая область"}),(0,b.jsx)(J,{value:"company",disabled:!m,className:"h-9 rounded-lg text-sm font-medium data-[state=active]:bg-white",children:"Настройки компании"})]}),(0,b.jsx)(K,{value:"profile",className:"space-y-8 mt-6",children:(0,b.jsxs)(f.Card,{className:"rounded-[0.75rem] border-0 shadow-none",style:S,children:[(0,b.jsxs)(f.CardHeader,{className:"border-b pb-4",style:{borderColor:P},children:[(0,b.jsx)(f.CardTitle,{style:{color:Q},children:"Профиль"}),(0,b.jsx)(f.CardDescription,{style:{color:R},children:"Имя отображается в боковой панели и в публичных ссылках."})]}),(0,b.jsxs)(f.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"profile-name",style:{color:Q},children:"Имя"}),(0,b.jsx)(g.Input,{id:"profile-name",value:n,onChange:a=>o(a.target.value),placeholder:"Ваше имя",autoComplete:"name"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"profile-email",style:{color:Q},children:"Email"}),(0,b.jsx)(g.Input,{id:"profile-email",value:j,disabled:!0})]})]}),(0,b.jsx)(f.CardFooter,{children:(0,b.jsx)("form",{className:"flex w-full justify-end",action:a=>{s(async()=>{a.set("name",n);let b=await N(a);L.toast[b.ok?"success":"error"](b.message)})},children:(0,b.jsx)(e.Button,{type:"submit",className:T,disabled:r||0===n.trim().length,children:"Сохранить"})})})]})}),(0,b.jsx)(K,{value:"workspace",className:"space-y-8 mt-6",children:(0,b.jsxs)(f.Card,{className:"rounded-[0.75rem] border-0 shadow-none",style:S,children:[(0,b.jsxs)(f.CardHeader,{className:"border-b pb-4",style:{borderColor:P},children:[(0,b.jsx)(f.CardTitle,{style:{color:Q},children:"Рабочая область"}),(0,b.jsx)(f.CardDescription,{style:{color:R},children:"Название видят коллеги и клиенты в приглашениях, публичных ссылках и PDF."})]}),(0,b.jsx)(f.CardContent,{className:"space-y-4",children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"workspace-name",style:{color:Q},children:"Название рабочей области"}),(0,b.jsx)(g.Input,{id:"workspace-name",value:p,onChange:a=>q(a.target.value),placeholder:"Например, «ООО Ромашка»",disabled:!m})]})}),(0,b.jsxs)(f.CardFooter,{className:"flex justify-between gap-3 flex-wrap",children:[m?(0,b.jsxs)("span",{className:"flex items-center gap-2 text-sm",style:{color:R},children:[(0,b.jsx)(d.Users,{className:"h-4 w-4"}),"Изменение повлияет на всех участников рабочей области."]}):(0,b.jsx)("p",{className:"text-sm",style:{color:R},children:"Только владелец или администратор может изменять название рабочей области."}),(0,b.jsx)("form",{className:"flex justify-end",action:a=>{u(async()=>{a.set("workspaceName",p);let b=await O(a);L.toast[b.ok?"success":"error"](b.message)})},children:(0,b.jsx)(e.Button,{type:"submit",className:T,disabled:!m||t||0===p.trim().length,children:"Обновить"})})]})]})}),(0,b.jsxs)(K,{value:"company",className:"space-y-8 mt-6",children:[(0,b.jsxs)(f.Card,{className:"rounded-[0.75rem] border-0 shadow-none",style:S,children:[(0,b.jsxs)(f.CardHeader,{className:"border-b pb-4",style:{borderColor:P},children:[(0,b.jsx)(f.CardTitle,{style:{color:Q},children:"Визуал компании"}),(0,b.jsx)(f.CardDescription,{style:{color:R},children:"Логотип, подпись и печать для документов"})]}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)("div",{className:"grid gap-6 md:grid-cols-3",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"logo-upload",style:{color:Q},children:"Логотип"}),v.logoUrl&&(0,b.jsx)("div",{className:"mb-2 flex h-32 items-center justify-center rounded-md border bg-[#FAFAFA]",style:{borderColor:P},children:(0,b.jsx)("img",{src:v.logoUrl,alt:"Логотип",className:"max-h-full max-w-full object-contain p-2"})}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("label",{htmlFor:"logo-upload",className:`inline-flex h-8 items-center rounded-md px-3 text-sm font-medium transition-colors ${"logoUrl"===x?"cursor-not-allowed bg-neutral-200 text-neutral-500":"cursor-pointer bg-[#F3F2F0] text-[#3d3d3a] hover:bg-[#ebe8e3]"}`,children:"Выбрать файл"}),(0,b.jsx)("span",{className:"truncate text-[12px]",style:{color:R},children:"logoUrl"===x?"Загрузка...":"PNG/JPG, до 5MB"}),(0,b.jsx)(g.Input,{id:"logo-upload",type:"file",accept:"image/*",disabled:"logoUrl"===x,className:"sr-only",onChange:a=>{let b=a.target.files?.[0];b&&C("logoUrl",b)}})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"signature-upload",style:{color:Q},children:"Подпись (PNG)"}),v.signatureUrl&&(0,b.jsx)("div",{className:"mb-2 flex h-32 items-center justify-center rounded-md border bg-[#FAFAFA]",style:{borderColor:P},children:(0,b.jsx)("img",{src:v.signatureUrl,alt:"Подпись",className:"max-h-full max-w-full object-contain p-2"})}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("label",{htmlFor:"signature-upload",className:`inline-flex h-8 items-center rounded-md px-3 text-sm font-medium transition-colors ${"signatureUrl"===x?"cursor-not-allowed bg-neutral-200 text-neutral-500":"cursor-pointer bg-[#F3F2F0] text-[#3d3d3a] hover:bg-[#ebe8e3]"}`,children:"Выбрать файл"}),(0,b.jsx)("span",{className:"truncate text-[12px]",style:{color:R},children:"signatureUrl"===x?"Загрузка...":"PNG, до 5MB"}),(0,b.jsx)(g.Input,{id:"signature-upload",type:"file",accept:"image/png",disabled:"signatureUrl"===x,className:"sr-only",onChange:a=>{let b=a.target.files?.[0];b&&C("signatureUrl",b)}})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"stamp-upload",style:{color:Q},children:"Печать (PNG)"}),v.stampUrl&&(0,b.jsx)("div",{className:"mb-2 flex h-32 items-center justify-center rounded-md border bg-[#FAFAFA]",style:{borderColor:P},children:(0,b.jsx)("img",{src:v.stampUrl,alt:"Печать",className:"max-h-full max-w-full object-contain p-2"})}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("label",{htmlFor:"stamp-upload",className:`inline-flex h-8 items-center rounded-md px-3 text-sm font-medium transition-colors ${"stampUrl"===x?"cursor-not-allowed bg-neutral-200 text-neutral-500":"cursor-pointer bg-[#F3F2F0] text-[#3d3d3a] hover:bg-[#ebe8e3]"}`,children:"Выбрать файл"}),(0,b.jsx)("span",{className:"truncate text-[12px]",style:{color:R},children:"stampUrl"===x?"Загрузка...":"PNG, до 5MB"}),(0,b.jsx)(g.Input,{id:"stamp-upload",type:"file",accept:"image/png",disabled:"stampUrl"===x,className:"sr-only",onChange:a=>{let b=a.target.files?.[0];b&&C("stampUrl",b)}})]})]})]})})]}),(0,b.jsxs)(f.Card,{className:"rounded-[0.75rem] border-0 shadow-none",style:S,children:[(0,b.jsxs)(f.CardHeader,{className:"border-b pb-4",style:{borderColor:P},children:[(0,b.jsx)(f.CardTitle,{style:{color:Q},children:"Реквизиты компании"}),(0,b.jsx)(f.CardDescription,{style:{color:R},children:"Информация для отображения в КП и документах"})]}),(0,b.jsxs)(f.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"companyName",style:{color:Q},children:"Название компании"}),(0,b.jsx)(g.Input,{id:"companyName",value:v.companyName,onChange:a=>B("companyName",a.target.value),placeholder:"ООО «Название»"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"inn",style:{color:Q},children:"ИНН"}),(0,b.jsx)(g.Input,{id:"inn",value:v.inn,onChange:a=>B("inn",a.target.value),placeholder:"1234567890"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"ogrn",style:{color:Q},children:"ОГРН"}),(0,b.jsx)(g.Input,{id:"ogrn",value:v.ogrn,onChange:a=>B("ogrn",a.target.value),placeholder:"1234567890123"})]}),(0,b.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,b.jsx)(h.Label,{htmlFor:"legalAddress",style:{color:Q},children:"Юридический адрес"}),(0,b.jsx)(g.Input,{id:"legalAddress",value:v.legalAddress,onChange:a=>B("legalAddress",a.target.value),placeholder:"123456, г. Москва, ул. Примерная, д. 1"})]})]}),(0,b.jsx)(i.Separator,{style:{backgroundColor:P}}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"mb-4 font-medium",style:{color:Q},children:"Банковские реквизиты"}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"bankName",style:{color:Q},children:"Название банка"}),(0,b.jsx)(g.Input,{id:"bankName",value:v.bankName,onChange:a=>B("bankName",a.target.value),placeholder:"ПАО «Банк»"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"bik",style:{color:Q},children:"БИК"}),(0,b.jsx)(g.Input,{id:"bik",value:v.bik,onChange:a=>B("bik",a.target.value),placeholder:"044525225"})]}),(0,b.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,b.jsx)(h.Label,{htmlFor:"accountNumber",style:{color:Q},children:"Расчётный счёт"}),(0,b.jsx)(g.Input,{id:"accountNumber",value:v.accountNumber,onChange:a=>B("accountNumber",a.target.value),placeholder:"40702810000000000000"})]})]})]})]})]}),(0,b.jsxs)(f.Card,{className:"rounded-[0.75rem] border-0 shadow-none",style:S,children:[(0,b.jsxs)(f.CardHeader,{className:"border-b pb-4",style:{borderColor:P},children:[(0,b.jsx)(f.CardTitle,{style:{color:Q},children:"Настройки НДС"}),(0,b.jsx)(f.CardDescription,{style:{color:R},children:"Параметры по умолчанию для новых КП"})]}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2 rounded-lg bg-[#FAFAFA] p-3",children:[(0,b.jsx)("input",{type:"checkbox",id:"vatDefault",checked:v.vatDefault,onChange:a=>B("vatDefault",a.target.checked),className:"h-4 w-4 rounded border-[var(--field-border)] accent-[var(--field-focus)] focus:ring-[3px] focus:ring-[var(--field-ring)]"}),(0,b.jsx)(h.Label,{htmlFor:"vatDefault",className:"cursor-pointer font-normal",style:{color:Q},children:"Включать НДС по умолчанию"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"vatRate",style:{color:Q},children:"Ставка НДС (%)"}),(0,b.jsx)(g.Input,{id:"vatRate",type:"number",min:"0",max:"100",value:v.vatRate,onChange:a=>B("vatRate",parseInt(a.target.value)||0)})]})]})}),(0,b.jsx)(f.CardFooter,{className:"flex justify-end",children:(0,b.jsx)(e.Button,{className:T,onClick:D,disabled:z,children:"Сохранить изменения"})})]})]})]})}}];

//# sourceMappingURL=_2beb44be._.js.map